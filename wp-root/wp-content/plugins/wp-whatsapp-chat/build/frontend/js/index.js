/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={445(e){function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},500(e,t){var n;!function(){"use strict";var a={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=s(e,o(n)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)a.call(e,n)&&e[n]&&(t=s(t,n));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},539(e){var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=t},635(e){var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,a=0;n<e.length;n++,a+=8)t[a>>>5]|=e[n]<<24-a%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],a=0;a<e.length;a+=3)for(var r=e[a]<<16|e[a+1]<<8|e[a+2],o=0;o<4;o++)8*a+6*o<=8*e.length?n.push(t.charAt(r>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],a=0,r=0;a<e.length;r=++a%4)0!=r&&n.push((t.indexOf(e.charAt(a-1))&Math.pow(2,-2*r+8)-1)<<2*r|t.indexOf(e.charAt(a))>>>6-2*r);return n}},e.exports=n},892(e,t,n){var a,r,o,s,c;a=n(635),r=n(539).utf8,o=n(445),s=n(539).bin,(c=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):r.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var n=a.bytesToWords(e),l=8*e.length,i=1732584193,p=-271733879,u=-1732584194,d=271733878,m=0;m<n.length;m++)n[m]=16711935&(n[m]<<8|n[m]>>>24)|4278255360&(n[m]<<24|n[m]>>>8);n[l>>>5]|=128<<l%32,n[14+(l+64>>>9<<4)]=l;var _=c._ff,w=c._gg,g=c._hh,h=c._ii;for(m=0;m<n.length;m+=16){var b=i,f=p,y=u,E=d;i=_(i,p,u,d,n[m+0],7,-680876936),d=_(d,i,p,u,n[m+1],12,-389564586),u=_(u,d,i,p,n[m+2],17,606105819),p=_(p,u,d,i,n[m+3],22,-1044525330),i=_(i,p,u,d,n[m+4],7,-176418897),d=_(d,i,p,u,n[m+5],12,1200080426),u=_(u,d,i,p,n[m+6],17,-1473231341),p=_(p,u,d,i,n[m+7],22,-45705983),i=_(i,p,u,d,n[m+8],7,1770035416),d=_(d,i,p,u,n[m+9],12,-1958414417),u=_(u,d,i,p,n[m+10],17,-42063),p=_(p,u,d,i,n[m+11],22,-1990404162),i=_(i,p,u,d,n[m+12],7,1804603682),d=_(d,i,p,u,n[m+13],12,-40341101),u=_(u,d,i,p,n[m+14],17,-1502002290),i=w(i,p=_(p,u,d,i,n[m+15],22,1236535329),u,d,n[m+1],5,-165796510),d=w(d,i,p,u,n[m+6],9,-1069501632),u=w(u,d,i,p,n[m+11],14,643717713),p=w(p,u,d,i,n[m+0],20,-373897302),i=w(i,p,u,d,n[m+5],5,-701558691),d=w(d,i,p,u,n[m+10],9,38016083),u=w(u,d,i,p,n[m+15],14,-660478335),p=w(p,u,d,i,n[m+4],20,-405537848),i=w(i,p,u,d,n[m+9],5,568446438),d=w(d,i,p,u,n[m+14],9,-1019803690),u=w(u,d,i,p,n[m+3],14,-187363961),p=w(p,u,d,i,n[m+8],20,1163531501),i=w(i,p,u,d,n[m+13],5,-1444681467),d=w(d,i,p,u,n[m+2],9,-51403784),u=w(u,d,i,p,n[m+7],14,1735328473),i=g(i,p=w(p,u,d,i,n[m+12],20,-1926607734),u,d,n[m+5],4,-378558),d=g(d,i,p,u,n[m+8],11,-2022574463),u=g(u,d,i,p,n[m+11],16,1839030562),p=g(p,u,d,i,n[m+14],23,-35309556),i=g(i,p,u,d,n[m+1],4,-1530992060),d=g(d,i,p,u,n[m+4],11,1272893353),u=g(u,d,i,p,n[m+7],16,-155497632),p=g(p,u,d,i,n[m+10],23,-1094730640),i=g(i,p,u,d,n[m+13],4,681279174),d=g(d,i,p,u,n[m+0],11,-358537222),u=g(u,d,i,p,n[m+3],16,-722521979),p=g(p,u,d,i,n[m+6],23,76029189),i=g(i,p,u,d,n[m+9],4,-640364487),d=g(d,i,p,u,n[m+12],11,-421815835),u=g(u,d,i,p,n[m+15],16,530742520),i=h(i,p=g(p,u,d,i,n[m+2],23,-995338651),u,d,n[m+0],6,-198630844),d=h(d,i,p,u,n[m+7],10,1126891415),u=h(u,d,i,p,n[m+14],15,-1416354905),p=h(p,u,d,i,n[m+5],21,-57434055),i=h(i,p,u,d,n[m+12],6,1700485571),d=h(d,i,p,u,n[m+3],10,-1894986606),u=h(u,d,i,p,n[m+10],15,-1051523),p=h(p,u,d,i,n[m+1],21,-2054922799),i=h(i,p,u,d,n[m+8],6,1873313359),d=h(d,i,p,u,n[m+15],10,-30611744),u=h(u,d,i,p,n[m+6],15,-1560198380),p=h(p,u,d,i,n[m+13],21,1309151649),i=h(i,p,u,d,n[m+4],6,-145523070),d=h(d,i,p,u,n[m+11],10,-1120210379),u=h(u,d,i,p,n[m+2],15,718787259),p=h(p,u,d,i,n[m+9],21,-343485551),i=i+b>>>0,p=p+f>>>0,u=u+y>>>0,d=d+E>>>0}return a.endian([i,p,u,d])})._ff=function(e,t,n,a,r,o,s){var c=e+(t&n|~t&a)+(r>>>0)+s;return(c<<o|c>>>32-o)+t},c._gg=function(e,t,n,a,r,o,s){var c=e+(t&a|n&~a)+(r>>>0)+s;return(c<<o|c>>>32-o)+t},c._hh=function(e,t,n,a,r,o,s){var c=e+(t^n^a)+(r>>>0)+s;return(c<<o|c>>>32-o)+t},c._ii=function(e,t,n,a,r,o,s){var c=e+(n^(t|~a))+(r>>>0)+s;return(c<<o|c>>>32-o)+t},c._blocksize=16,c._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=a.wordsToBytes(c(e,t));return t&&t.asBytes?n:t&&t.asString?s.bytesToString(n):a.bytesToHex(n)}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.React,t=window.wp.element;var a=n(500),r=n.n(a),o=n(892),s=n.n(o);const c=window.wp.i18n,l="persist:qlwapp",i={id:"",source:"user",text:"",status:"",type:"text"},p={contactId:null,contactsConversation:{},contactResponseIsLoading:!1,generalConsentAccepted:!1},u=async(e,t)=>fetch("https://viewer.quick.bot/api"+e,{...t,headers:{Accept:"application/json","Content-Type":"application/json",Origin:window.location.origin}}),d=e=>{const t={isStreamEnabled:!1,isOnlyRegistering:!1,textBubbleContentFormat:"markdown"};return e&&(t.message={type:"text",text:e}),JSON.stringify(t)},m=()=>{let e=(new Date).getTime();const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)});return t};function _(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function w(e,t){const n={...e};return Object.keys(t).forEach(a=>{const r=e[a],o=t[a];_(r)&&_(o)&&!Array.isArray(r)?n[a]=w(r,o):n[a]=o}),n}const g=e=>{if(!e)return"";const t=e.toLowerCase();return t.startsWith("http://")||t.startsWith("https://")?e:`https://${e}`},h=(0,t.createContext)(),b=(e,t)=>{const{contacts:n,contactId:a,storeName:r}=t.payload||{};switch(t.type){case"PERSIST_STATE":return((e,t,n=30)=>{let a=localStorage.getItem(e);if(a)a=JSON.parse(a),a.value=t;else{const e=new Date;a={value:t,expiration:new Date(e.getTime()+24*n*60*60*1e3).getTime()}}try{localStorage.setItem(e,JSON.stringify(a))}catch(t){if("QuotaExceededError"===t.name){console.warn("localStorage quota exceeded. Attempting to clear old data...");try{localStorage.removeItem(e),localStorage.setItem(e,JSON.stringify(a))}catch(e){console.error("Failed to save to localStorage even after clearing:",e)}}else console.error("Error saving to localStorage:",t)}})(r,{...e,contactsHash:s()(JSON.stringify(t.payload.contacts))}),e;case"HYDRATE_STATE":const o=(e=>{const t=localStorage.getItem(e);if(t){const n=JSON.parse(t);return(new Date).getTime()>n.expiration?(localStorage.removeItem(e),null):n.value}return null})(r),c=s()(JSON.stringify(n));return o?o.contactsHash!==c?{...p,contactsHash:c}:(n.find(e=>"bot"===e.type?e.bot_id===a:e.id===a)||(o.contactId=null),{...o}):e;case"SET_CONTACT_ID":if(null===a)return{...e,contactId:null};const l=n.find(e=>"bot"===e.type?e.bot_id===a:e.id===a),i=l?.message||"",u="bot"===l?.type,d=e.contactsConversation[a];return!d||!u&&(d?.messageListArray?.[0]?.text||"")!==i?w(e,{contactId:a,contactsConversation:{[a]:{clientSideAction:null,messageListArray:""!==i?[{id:"",source:"user",text:i,status:""}]:[],sessionId:null,threadOpenaiId:""}}}):{...e,contactId:a};case"SET_GENERAL_CONSENT_ACCEPTED":const{accepted:m}=t.payload;return{...e,generalConsentAccepted:m};case"SET_CONTACT_CONVERSATION_MESSAGE":const _=[...e.contactsConversation[e.contactId]?.messageListArray||[],{...t.payload}];return w(e,{contactsConversation:{[e.contactId]:{messageListArray:_}}});case"SET_CONTACT_CONVERSATION_RESPONSE_IS_LOADING":return w(e,{contactResponseIsLoading:t.payload});case"UPDATE_CONTACT_CONVERSATION_MESSAGE":{const{id:n,message:a}=t.payload,r=e.contactsConversation[e.contactId].messageListArray.findIndex(e=>e.id===n),o=w(e.contactsConversation[e.contactId].messageListArray[r]||"",a),s=[...e.contactsConversation[e.contactId].messageListArray];return s.splice(r,1,o),w(e,{contactsConversation:{[e.contactId]:{messageListArray:s}}})}case"REMOVE_CONTACT_CONVERSATION_MESSAGE":{const{id:n,status:a}=t.payload,r=e.contactsConversation[e.contactId].messageListArray,o="error"===a?r.filter(e=>"error"!==e.status):r.filter(e=>e.id!==n);return w(e,{contactsConversation:{[e.contactId]:{messageListArray:o}}})}case"SET_SESSION_ID":return w(e,{contactsConversation:{[e.contactId]:{sessionId:t.payload.sessionId}}});case"SET_USER_INPUTS":return w(e,{contactsConversation:{[e.contactId]:{userInputs:t.payload}}});case"SET_CLIENT_SIDE_ACTION":return w(e,{contactsConversation:{[e.contactId]:{clientSideAction:t.payload}}});case"RESET_CONTACT_CONVERSATION":return w(e,{contactsConversation:{[e.contactId]:{clientSideAction:null,messageListArray:[],userInputs:[],sessionId:null}}})}return e},f=()=>(0,t.useContext)(h),y=n=>{const{contacts:a,children:r}=n,[o,s]=(0,t.useReducer)(b,p),_=l,w=(0,t.useCallback)(()=>{try{const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&n.startsWith(l+":")&&n!==l&&e.push(n)}e.forEach(e=>localStorage.removeItem(e))}catch(e){console.warn("Failed to cleanup old storage entries:",e)}},[]),f=(0,t.useCallback)(()=>{s({type:"PERSIST_STATE",payload:{contacts:a,storeName:_}})},[a,_]),y=(0,t.useCallback)(()=>{s({type:"HYDRATE_STATE",payload:{contacts:a,storeName:_}})},[a,_]),E=e=>{const{type:t,items:n,options:a}=e,r=a?.labels,o=[t,n,r].every(e=>void 0===e)?void 0:{type:t,items:n,labels:r};s({type:"SET_USER_INPUTS",payload:o})},v=e=>{const t=m();return s({type:"SET_CONTACT_CONVERSATION_MESSAGE",payload:{...i,...e,source:"user",id:t}}),t},C=e=>{const t=m(),n={...i,...e,source:"agent",id:t};return s({type:"SET_CONTACT_CONVERSATION_MESSAGE",payload:n}),t},N=e=>{s({type:"SET_CONTACT_CONVERSATION_RESPONSE_IS_LOADING",payload:e})},S=e=>{s({type:"UPDATE_CONTACT_CONVERSATION_MESSAGE",payload:e})},x=({id:e,status:t})=>{s({type:"REMOVE_CONTACT_CONVERSATION_MESSAGE",payload:{id:e,status:t}})},T=e=>{s({type:"SET_CLIENT_SIDE_ACTION",payload:e})},I=(0,t.useCallback)(async e=>{if(!o.contactId)return;N(!0),E([]),T(null),x({status:"error"}),e&&v({text:e});const t=C({status:"waiting"}),n=o.contactsConversation[o.contactId]?.sessionId;try{let r;if(r=n?await(async(e,t)=>{try{const n=await u(`/v1/sessions/${e}/continueChat`,{method:"POST",body:d(t)}),a=await n.json();return n.ok?{ok:!0,data:a}:{ok:!1,code:a?.code||"unknown_error",message:a?.message||"Request failed"}}catch(e){return console.error("continueChat unexpected error:",e),{ok:!1,code:e?.code||"unknown_error",message:e?.message||"Request failed"}}})(n,e):await(async(e,t)=>{try{const n=`/v1/bots/${e}/startChat`,a=await u(n,{method:"POST",body:d(t)}),r=await a.json();return a.ok?{ok:!0,data:r}:{ok:!1,code:r?.code||"unknown_error",message:r?.message||"Request failed"}}catch(e){return console.error("starChat unexpected error:",e),{ok:!1,code:e?.code||"unknown_error",message:e?.message||"Request failed"}}})(o.contactId,e||""),!r.ok)return S({id:t,message:{text:r.message||(0,c.__)("There was an error with the response. Please try again.","wp-whatsapp-chat"),status:"error"}}),void N(!1);n||(a=r.data.sessionId,s({type:"SET_SESSION_ID",payload:{sessionId:a}}));const{messages:l,input:i,clientSideActions:p}=r.data;0===l?.length?(x({id:t}),N(!1)):l.forEach(({content:e,type:n},a)=>{let r;r="image"===n?{type:"image",text:g(e?.url)}:"video"===n?{type:"video",text:(e=>{if(!e)return e;const t=new RegExp("^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#&?]*).*"),n=e.match(t);return n&&11===n[7].length?`https://www.youtube.com/embed/${n[7]}`:e})(g(e?.url))}:"audio"===n?{type:"audio",text:g(e?.url)}:"embed"===n?{type:"embed",text:g(e?.url)}:{type:"text",text:e?.markdown||""},0===a?S({id:t,message:{...r,status:"success"}}):C(r)}),i&&E(i),p?.length&&p.forEach(e=>{if("redirect"===e.type){const{isNewTab:t,url:n}=e.redirect;T({type:"redirect",isNewTab:t,url:n})}}),N(!1)}catch(e){return S({id:t,message:{text:(0,c.__)("There was an error with the response. Please try again.","wp-whatsapp-chat"),status:"error"}}),N(!1),null}var a},[o.contactId,o.contactsConversation]);return(0,t.useEffect)(()=>{w()},[w]),(0,t.useEffect)(()=>{y()},[y]),(0,t.useEffect)(()=>{f()},[o,f]),(0,e.createElement)(h.Provider,{value:{...o,...n,setContactId:e=>{s({type:"SET_CONTACT_ID",payload:{contacts:a,contactId:e,storeName:_}})},setContactConversationMessageUser:v,setContactConversationMessageAgent:C,setContactConversationResponseIsLoading:N,updateContactConversationMessage:S,setUserInputs:E,chatWithBot:I,resetContactConversation:()=>{s({type:"RESET_CONTACT_CONVERSATION"})},setGeneralConsentAccepted:e=>{s({type:"SET_GENERAL_CONSENT_ACCEPTED",payload:{accepted:e}})}}},r)},E=()=>(0,e.createElement)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},(0,e.createElement)("path",{d:"M20.563 22.104l-1.875 1.875-8-8 8-8 1.875 1.875-6.125 6.125z"})),v=({contact:t})=>{const{box:n}=f();return(0,e.createElement)("div",{className:"qlwapp__avatar"},(0,e.createElement)("div",{className:"qlwapp__avatar__container"},t?.avatar?function(e){try{return new URL(e),!0}catch(e){return!1}}(t.avatar)?(0,e.createElement)("img",{src:t.avatar,alt:t.firstname,loading:"yes"===n.lazy_load&&"lazy"}):(0,e.createElement)("div",{className:"qlwapp__avatar__container qlwapp__avatar__container--icon"},(0,e.createElement)("span",null,t?.avatar)):(0,e.createElement)("div",{className:"qlwapp__avatar__container qlwapp__avatar__container--icon"},(0,e.createElement)("span",null,t?.name?.charAt(0).toUpperCase()))))},C=()=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 32 32"},(0,e.createElement)("path",{fill:"currentColor",d:"M27 8H6.83l3.58-3.59L9 3L3 9l6 6l1.41-1.41L6.83 10H27v16H7v-7H5v7a2 2 0 0 0 2 2h20a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2"})),N=(e,t)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t(e))},S=()=>{const{contactId:t,contacts:n,resetContactConversation:a}=f(),r=n.find(e=>"bot"===e.type?e.bot_id===t:e.id===t);if("bot"===r?.type)return(0,e.createElement)("a",{className:"qlwapp__previous qlwapp__reset",title:(0,c.__)("Reset conversation","wp-whatsapp-chat"),onClick:()=>a(),onKeyDown:e=>N(e,()=>a()),role:"button",tabIndex:"0"},(0,e.createElement)(C,null))},x=({onClose:t,onPrevious:n})=>{const{contactId:a,box:o,contacts:s,contactResponseIsLoading:l,contactsConversation:i}=f(),{userInputs:p,threadOpenaiId:u}=i[a]||{},d=s.find(e=>"bot"===e.type?e.bot_id===a:e.id===a),m=!l&&""===u&&!p;return(0,e.createElement)("div",{className:"qlwapp__header"},(0,e.createElement)("i",{className:"qlwapp__close",onClick:t,onKeyDown:e=>N(e,t),role:"button",tabIndex:"0"},"×"),(0,e.createElement)("div",{className:"qlwapp__carousel"},(0,e.createElement)("div",{className:"qlwapp__carousel-slide"},o.header&&(0,e.createElement)("div",{className:"qlwapp__header-description",dangerouslySetInnerHTML:{__html:o.header}})),(0,e.createElement)("div",{className:"qlwapp__carousel-slide"},(0,e.createElement)("div",{className:"qlwapp__header-contact"},(0,e.createElement)("div",{className:"qlwapp__header-contact-buttons"},(0,e.createElement)("a",{className:r()("qlwapp__previous",l&&"qlwapp__previous--disabled"),onClick:n,onKeyDown:e=>N(e,n),role:"button",tabIndex:"0"},(0,e.createElement)(E,null)),m&&(0,e.createElement)(S,null)),(0,e.createElement)("div",{className:"qlwapp__info"},(0,e.createElement)("span",{className:"qlwapp__name"},`${d?.firstname} ${d?.lastname}`),(0,e.createElement)("span",{className:"qlwapp__time"},d?.timefrom!==d?.timeto&&(0,c.sprintf)((0,c._x)("Available from %1$s to %2$s","wp-whatsapp-chat"),d?.timefrom,d?.timeto),d?.label&&` - ${d?.label}`)),(0,e.createElement)(v,{contact:d})))))},T=()=>(0,e.createElement)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},(0,e.createElement)("path",{d:"M2.776 31.54c-1.954 1.036-3.144 0.122-2.658-2.038l2.066-9.17c0.246-1.086 1.318-2.068 2.432-2.2l12.39-1.44c3.296-0.38 3.308-0.996 0-1.374l-12.39-1.416c-1.1-0.126-2.18-1.080-2.424-2.17l-2.080-9.264c-0.486-2.146 0.704-3.046 2.662-2.006l25.7 13.658c1.956 1.038 1.96 2.72 0 3.76l-25.7 13.66z"})),I=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t=window.matchMedia("(pointer:coarse)");return t&&t.matches||e},q=({type:e,group:t,phone:n,message:a,whatsapp_link_type:r="web"})=>{const o=I()?"api":r,s="api"===o?"https://api.whatsapp.com/send":"https://web.whatsapp.com/send";if("group"===e){const e=(e=>{try{const t=new URL(e);if("chat.whatsapp.com"===t.hostname)return t.pathname.replace("/","");if("web.whatsapp.com"===t.hostname&&"/accept"===t.pathname)return t.searchParams.get("code")}catch(e){console.error("Invalid URL",e)}return null})(t);return"api"===o?`https://chat.whatsapp.com/${e}`:`https://web.whatsapp.com/accept?code=${e}`}return`${s}?phone=${function(e){return(e=e.replace(new RegExp("[^0-9]","g"),"")).replace(new RegExp("^0+"),"")}(n?.toString())}&text=${encodeURIComponent(function(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}(a))}`};function A(e){const t=q(e),n=new CustomEvent("qlwapp.click",{bubbles:!0,cancelable:!0});window.dispatchEvent(n),window.open(t,"_blank","noreferrer")}const k=()=>{const{button:n,box:a,contacts:o,contactId:s,contactsConversation:l,contactResponseIsLoading:i,chatWithBot:p,generalConsentAccepted:u}=f(),d=o.find(e=>"bot"===e.type?e.bot_id===s:e.id===s),[m,_]=(0,t.useState)(""),w=(0,t.useRef)(),g=(0,t.useRef)(null),{userInputs:h,threadOpenaiId:b}=l[s]||{},y=["text input","email input","number input","url input","phone number input"],E=e=>y.includes(e),v=e=>"date input"===e,C="bot"!==d?.type||"bot"===d?.type&&(E(h?.type)||v(h?.type));(0,t.useEffect)(()=>{C&&w.current&&w.current.focus()},[C]);const N="yes"===a?.consent_enabled&&!u,S=!m.trim()||i||N,x=(e=!1)=>{const t=w.current;t&&(t.style.height="",e||""!==!m||(t.style.height=`${t.scrollHeight}px`))},I=e=>{e.preventDefault();let t=e.target.value;"phone number input"===h?.type&&(t=t.replace(new RegExp("\\+","g"),""),t=t.replace(new RegExp("[^\\d\\s-]","g"),""),t.trim()&&(t="+"+t)),_(t),x()},q=e=>{e.preventDefault(),(()=>{if(S)return;const e=m.trim();_(""),x(!0),"bot"===d?.type?p(e):A({...d,message:m,whatsapp_link_type:n.whatsapp_link_type})})()},k=(0,t.useCallback)(e=>{if(g.current&&(g.current.disconnect(),g.current=null),!e)return;const t=()=>{const t=e.getBoundingClientRect().width;document.documentElement.style.setProperty("--qlwapp-button-width",`${t}px`)};t();const n=requestAnimationFrame(t),a=new ResizeObserver(t);return a.observe(e),g.current=a,()=>{cancelAnimationFrame(n),a.disconnect()}},[s]),O="bot"===d?.type&&!i&&""===b&&!h;return(0,e.createElement)(e.Fragment,null,a?.footer&&(0,e.createElement)("div",{className:"qlwapp__footer",dangerouslySetInnerHTML:{__html:a.footer}}),C&&(0,e.createElement)("div",{className:"qlwapp__response"},(E(h?.type)||"bot"!==d?.type)&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("pre",{className:"qlwapp__response__input"},m),(0,e.createElement)("textarea",{className:"qlwapp__response__input",name:"message",ref:w,maxLength:"300",onChange:I,onKeyDown:e=>{e.shiftKey&&"Enter"===e.key||"Enter"!==e.key||S||q(e)},value:m,placeholder:(()=>{if("bot"!==d?.type)return a?.response;if(!h?.labels?.placeholder){const e=h?.type.split(" ")[0]||"text";return(0,c.sprintf)((0,c.__)("Type your %s","wp-whatsapp-chat"),e)}return h?.labels?.placeholder})(),"aria-label":a?.response,tabIndex:"0",disabled:i||N})),v(h?.type)&&(0,e.createElement)("input",{type:"date",className:"qlwapp__response__input",onChange:I,disabled:N,required:!0}),(0,e.createElement)("div",{className:"qlwapp__response__buttons",ref:k},(0,e.createElement)("a",{className:r()("qlwapp__reply",S&&"qlwapp__reply--disabled"),role:"button",tabIndex:"0",onClick:q,title:(0,c.__)("Send","wp-whatsapp-chat"),target:"bot"!==d?.type?"blank":void 0},(0,e.createElement)(T,null)))),O&&(0,e.createElement)("div",{className:"qlwapp__response qlwapp__response--end-conversation"},(0,e.createElement)("pre",{className:"qlwapp__response__input"},(0,c.__)("This conversation has ended.","wp-whatsapp-chat"))))};function O(e,t){return parseInt(e+t)}function R(e){let t=""+e.getMinutes();return 1===t.length&&(t="0"+t),e.getHours()+":"+t}const L=({timezone:e,timefrom:t,timeto:n,timedays:a})=>{const r=(({timedays:e})=>{const t=(new Date).getDay().toString();return e?.includes(t)||0===e?.length})({timedays:a}),o=function(e){let t=0;if(e?.includes("UTC")){const n=e.replace(new RegExp("UTC\\+?"),"");isNaN(n)||(t=60*parseInt(n))}else try{const n=(new Date).toLocaleString("en-US",{timeZone:e});t=(new Date(n+" UTC")-new Date)/6e4}catch(e){return 0}return t}(e),s=new Date,c=new Date,l=new Date;let i=c.getTime(),p=s.getTime();if(t!==n){const e=-l.getTimezoneOffset()-(o||0);let a,u;a=O(t[0],t[1]),u=O(t[3],t[4]),c.setHours(a),c.setMinutes(u+e),i=c.getTime(),a=O(n[0],n[1]),u=O(n[3],n[4]),s.setHours(a),s.setMinutes(u+e),p=s.getTime(),i>p&&(i-=864e5);const d=i<=l.getTime()&&l.getTime()<=p;return{isAvailableNow:r&&d,isInAvailableDay:r,isInAvailableHour:d,timefrom:R(c),timeto:R(s)}}return{isAvailableNow:r,isInAvailableDay:r,isInAvailableHour:!0}};function D(e,t){return!!e.includes(parseInt(t))||!!e.includes(t.toString())}function M({timedays:e,timezone:t}){const n=function(e){try{let t=new Date;const n={weekday:"long"},a=function(e){const t=e.match(new RegExp("^UTC([+-]\\d{1,2})$"));return t?60*parseInt(t[1],10)*60*1e3:null}(e);if(null!==a){const e=new Date(t.getTime()+6e4*t.getTimezoneOffset()+a);n.timeZone="UTC",t=e}else n.timeZone=e;return{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6}[new Intl.DateTimeFormat("en-US",n).formatToParts(t).find(e=>"weekday"===e.type).value]}catch(e){return null}}(t);if(null===n)return!1;const a=[(0,c.__)("Sunday","wp-whatsapp-chat"),(0,c.__)("Monday","wp-whatsapp-chat"),(0,c.__)("Tuesday","wp-whatsapp-chat"),(0,c.__)("Wednesday","wp-whatsapp-chat"),(0,c.__)("Thursday","wp-whatsapp-chat"),(0,c.__)("Friday","wp-whatsapp-chat"),(0,c.__)("Saturday","wp-whatsapp-chat")];for(let t=n;t<=6;t++)if(D(e,t))return a[t];for(let t=0;t<n;t++)if(D(e,t))return a[t];return!1}const $=({contact:t,onClick:n})=>{const{box:a,generalConsentAccepted:o}=f(),{isAvailableNow:s,isInAvailableDay:l,isInAvailableHour:i,timefrom:p,timeto:u}=L(t);if(!s&&"hidden"===t.visibility)return;const d=M(t),m="yes"===a?.consent_enabled&&!o;return(0,e.createElement)("a",{className:r()("qlwapp__contact",!s&&"readonly"===t.visibility||m?"qlwapp__contact--disabled":""),onClick:n,onKeyDown:N,role:"button",tabIndex:"0",target:"_blank"},(0,e.createElement)(v,{contact:t}),(0,e.createElement)("div",{className:"qlwapp__info"},(0,e.createElement)("span",{className:"qlwapp__label"},t?.label),(0,e.createElement)("span",{className:"qlwapp__name"},"bot"===t?.type?t?.firstname:`${t?.firstname} ${t?.lastname}`),"with_status"===t?.visibility&&(0,e.createElement)("div",{className:"qlwapp__status qlwapp__info"},(0,e.createElement)("div",{className:"qlwapp__status__indicator "+(s?"qlwapp__status__indicator--online":"qlwapp__status__indicator--offline")}),(0,e.createElement)("span",{className:"qlwapp__status__text"},s?"Online":"Offline")),l?!i&&(0,e.createElement)("span",{className:"qlwapp__time"},(0,c.sprintf)((0,c._x)("Available from %1$s to %2$s","wp-whatsapp-chat"),p,u)):d&&(0,e.createElement)("span",{className:"qlwapp__time"},(0,c.sprintf)((0,c._x)("Available on %s","wp-whatsapp-chat"),d))))},P=({onClick:n})=>{const[,a]=(()=>{const[e,n]=(0,t.useState)(!1);return[e,e=>{n(!0),setTimeout(()=>{e(),n(!1)},0)}]})(),{box:r,button:o,contacts:s,setContactId:l,generalConsentAccepted:i}=f(),p=e=>t=>{t.preventDefault(),"yes"===r?.consent_enabled&&!i||(e.chat||"bot"===e?.type?(n("qlwapp__modal--opening"),a(()=>{l("bot"===e.type?e.bot_id:e.id)})):A({...e,whatsapp_link_type:o.whatsapp_link_type}))},u=()=>{const e=document.querySelector(".qlwapp__header")?.offsetHeight,t=r.footer?document.querySelector(".qlwapp__footer")?.offsetHeight:document.querySelector(".qlwapp__response")?.offsetHeight;let n=window.innerHeight-e-t;I()&&(n=.7*window.innerHeight-e-t),document.documentElement.style.setProperty("--qlwapp-scheme-box-height",`${n}px`)};return(0,t.useEffect)(()=>(window.addEventListener("resize",u()),window.addEventListener("load",u()),()=>{window.removeEventListener("resize",u()),window.removeEventListener("load",u())}),[]),(0,e.createElement)("div",{className:"qlwapp__contact-list"},s.length?s.map(t=>(0,e.createElement)($,{key:t.id,contact:t,onClick:p(t)})):(0,e.createElement)("div",{className:"qlwapp__contact-list__empty"},(0,c.__)("No contacts found.","wp-whatsapp-chat")))},H=()=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},(0,e.createElement)("circle",{cx:"18",cy:"12",r:"0",fill:"currentColor"},(0,e.createElement)("animate",{attributeName:"r",begin:".67",calcMode:"spline",dur:"1.5s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8",repeatCount:"indefinite",values:"0;2;0;0"})),(0,e.createElement)("circle",{cx:"12",cy:"12",r:"0",fill:"currentColor"},(0,e.createElement)("animate",{attributeName:"r",begin:".33",calcMode:"spline",dur:"1.5s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8",repeatCount:"indefinite",values:"0;2;0;0"})),(0,e.createElement)("circle",{cx:"6",cy:"12",r:"0",fill:"currentColor"},(0,e.createElement)("animate",{attributeName:"r",begin:"0",calcMode:"spline",dur:"1.5s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8",repeatCount:"indefinite",values:"0;2;0;0"})));var B={"":["<em>","</em>"],_:["<strong>","</strong>"],"*":["<strong>","</strong>"],"~":["<s>","</s>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function U(e){return e.replace(RegExp("^"+(e.match(/^(\t| )+/)||"")[0],"gm"),"")}function j(e){return(e+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function F(e,t){var n,a,r,o,s,c=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^``` *(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:!\[([^\]]*?)\]\(([^)]+?)\))|(\[)|(\](?:\(([^)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,6})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*]|~~)/gm,l=[],i="",p=t||{},u=0;function d(e){var t=B[e[1]||""],n=l[l.length-1]==e;return t?t[1]?(n?l.pop():l.push(e),t[0|n]):t[0]:e}function m(){for(var e="";l.length;)e+=d(l[l.length-1]);return e}for(e=e.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(e,t,n){return p[t.toLowerCase()]=n,""}).replace(/^\n+|\n+$/g,"");r=c.exec(e);)a=e.substring(u,r.index),u=c.lastIndex,n=r[0],a.match(/[^\\](\\\\)*\\$/)||((s=r[3]||r[4])?n='<pre class="code '+(r[4]?"poetry":r[2].toLowerCase())+'"><code'+(r[2]?' class="language-'+r[2].toLowerCase()+'"':"")+">"+U(j(s).replace(/^\n+|\n+$/g,""))+"</code></pre>":(s=r[6])?(s.match(/\./)&&(r[5]=r[5].replace(/^\d+/gm,"")),o=F(U(r[5].replace(/^\s*[>*+.-]/gm,""))),">"==s?s="blockquote":(s=s.match(/\./)?"ol":"ul",o=o.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),n="<"+s+">"+o+"</"+s+">"):r[8]?n='<img src="'+j(r[8])+'" alt="'+j(r[7])+'">':r[10]?(i=i.replace("<a>",'<a href="'+j(r[11]||p[a.toLowerCase()])+'">'),n=m()+"</a>"):r[9]?n="<a>":r[12]||r[14]?n="<"+(s="h"+(r[14]?r[14].length:r[13]>"="?1:2))+">"+F(r[12]||r[15],p)+"</"+s+">":r[16]?n="<code>"+j(r[16])+"</code>":(r[17]||r[1])&&(n=d(r[17]||"--"))),i+=a,i+=n;return(i+e.substring(u)+m()).replace(/^\n+|\n+$/g,"")}function V(e){if(null==e)return"";const t=new RegExp("(https?:\\/\\/[^\\s<]+)","g"),n=[];let a=F(e.replace(t,e=>{const t=`URLPLACEHOLDER${n.length}URLPLACEHOLDER`;return n.push(e),t}));return n.forEach((e,t)=>{const n=`URLPLACEHOLDER${t}URLPLACEHOLDER`;a=a.replace(n,e)}),a}const z=({text:t,status:n,source:a,type:o})=>{const s=["image","video","audio","embed"].includes(o)?t:V((e=>{if(!e||"string"!=typeof e)return e;const t=document.createElement("textarea");return t.innerHTML=e,t.value.replace(new RegExp("&","g"),"&amp;").replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;").replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("'","g"),"&#039;").replace(new RegExp("\\n","g"),"<br>")})(t)),c={__html:s};return(0,e.createElement)("div",{className:r()("qlwapp__message",a&&`qlwapp__message--${a}`,n&&`qlwapp__message--${n}`,o&&`qlwapp__message--${o}`)},(()=>{if("waiting"===n)return(0,e.createElement)("span",{className:"qlwapp__message--spinner"},(0,e.createElement)(H,null));switch(o){case"image":return(0,e.createElement)("img",{className:"qlwapp__message--image",src:t,alt:t});case"video":return t.includes("youtube.com/embed/")?(0,e.createElement)("iframe",{className:"qlwapp__message--video-embed",src:t,title:"Video content",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):(0,e.createElement)("video",{className:"qlwapp__message--video",controls:!0,src:t},"Your browser does not support the video tag.");case"audio":return(0,e.createElement)("audio",{className:"qlwapp__message--audio",controls:!0,src:t},"Your browser does not support the audio tag.");case"embed":return(0,e.createElement)("iframe",{className:"qlwapp__message--embed",src:t,title:"Embedded content",frameBorder:"0",allowFullScreen:!0});default:return(0,e.createElement)("div",{dangerouslySetInnerHTML:c})}})())},G={buttonType:"Numbers",length:10,labels:{button:(0,c.__)("Send","wp-whatsapp-chat")},startsAt:1,customIcon:{isEnabled:!1},isOneClickSubmitEnabled:!1},W=({rating:t,idx:n,onClick:a,buttonType:r,customIcon:o,isOneClickSubmitEnabled:s})=>{const c=e=>{e.preventDefault(),a(n)},l=void 0!==t&&n<=t;if("Numbers"===r)return s?(0,e.createElement)("button",{type:"button",className:"qlwapp__message qlwapp__message--choice-input",onClick:c},n):(0,e.createElement)("div",{role:"checkbox","aria-checked":l,tabIndex:0,onClick:c,onKeyDown:e=>N(e,c),className:"qlwapp__rating-number "+(l?"qlwapp__rating-number--selected":"")},n);const i=o?.isEnabled&&o?.svg?o.svg:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>';return(0,e.createElement)("div",{className:"qlwapp__rating-icon "+(l?"qlwapp__rating-icon--selected":""),onClick:c,onKeyDown:e=>N(e,c),role:"checkbox","aria-checked":l,tabIndex:0,dangerouslySetInnerHTML:{__html:i}})},J=({options:n={},onSubmit:a})=>{const[r,o]=(0,t.useState)(void 0),s={...G,...n,labels:{...G.labels,...n.labels},customIcon:{...G.customIcon,...n.customIcon}},c=e=>{s.isOneClickSubmitEnabled?a(e.toString()):o(e)},l=s.buttonType||"Numbers",i=s.length||10,p="Numbers"===l&&s.startsAt||1,u="Numbers"===l?i-(p-1):i,d=[];for(let e=0;e<u;e++){const t="Numbers"===l?e+p:e+1;d.push(t)}return(0,e.createElement)("form",{className:"qlwapp__rating-form",onSubmit:e=>{e.preventDefault(),void 0!==r&&a(r.toString())}},s.labels?.left&&(0,e.createElement)("span",{className:"qlwapp__rating-label qlwapp__rating-label--left"},s.labels.left),(0,e.createElement)("div",{className:"qlwapp__rating-buttons"},d.map(t=>(0,e.createElement)(W,{key:t,idx:t,rating:r,buttonType:l,customIcon:s.customIcon,isOneClickSubmitEnabled:s.isOneClickSubmitEnabled,onClick:c}))),s.labels?.right&&(0,e.createElement)("span",{className:"qlwapp__rating-label qlwapp__rating-label--right"},s.labels.right),(0,e.createElement)("div",{className:"qlwapp__rating-submit"},void 0!==r&&(0,e.createElement)("button",{type:"submit",className:"qlwapp__message qlwapp__message--choice-input"},s.labels?.button||G.labels.button)))},K=()=>{const n=(0,t.useRef)(null),[a,r]=(0,t.useState)(!1),{contactId:o,contactsConversation:s,chatWithBot:l,contactResponseIsLoading:i,contacts:p}=f(),u=p?.some(e=>"bot"===e.type&&e.bot_id===o),{messageListArray:d=[],userInputs:m,sessionId:_,clientSideAction:w}=s[o]||{messageListArray:[]};return(0,t.useEffect)(()=>{n.current&&d.length>0&&setTimeout(()=>{n.current?.scrollIntoView({behavior:"smooth",block:"nearest"})},[700])},[d]),(0,t.useEffect)(()=>{null===_&&u&&l()},[_,u]),(0,t.useEffect)(()=>{w&&"redirect"===w?.type?w?.isNewTab?window.open(w.url,"_blank")||r(!0):window.location.href=w.url:r(!1)},[w]),(0,e.createElement)("div",{className:"qlwapp__message-list"},d.map(t=>(0,e.createElement)(z,{key:t.id,...t})),"buttons input"==m?.type&&!i&&m?.items.map(({id:t,content:n,pictureSrc:a})=>(0,e.createElement)("div",{className:"qlwapp__message qlwapp__message--choice-input",key:t,type:"text",role:"button",tabIndex:0,onClick:e=>{e.stopPropagation(),l(n)},onKeyDown:e=>{e.stopPropagation(),N(e,()=>l(n))},disabled:i},a?(0,e.createElement)("img",{src:a,alt:"option icon"}):n)),"rating input"==m?.type&&!i&&(0,e.createElement)(J,{options:m?.options,onSubmit:e=>l(e)}),a&&w?.url&&(0,e.createElement)("div",{className:"qlwapp__message qlwapp__message--user"},(0,e.createElement)("div",null,(0,c.__)("The bot wants to open a new tab but it was blocked by your browser. It needs a manual approval.","wp-whatsapp-chat")),(0,e.createElement)("a",{href:w.url,target:"_blank",rel:"noopener noreferrer",onClick:()=>r(!1)},(0,c.__)("Continue in a new tab","wp-whatsapp-chat"))),(0,e.createElement)("span",{ref:n}))},Y=()=>{const{box:n,generalConsentAccepted:a,setGeneralConsentAccepted:r}=f(),[o,s]=(0,t.useState)(!0),[l,i]=(0,t.useState)(!1),p="yes"===n?.consent_enabled,u=n?.consent_message||(0,c.__)("I accept cookies and privacy policy.","wp-whatsapp-chat");return p&&o?(0,e.createElement)("div",{className:`qlwapp__general-consent ${l?"qlwapp__general-consent--accepted":""} ${a?"":"qlwapp__general-consent--required"}`},(0,e.createElement)("label",{className:"qlwapp__general-consent-label"},(0,e.createElement)("input",{id:"qlwapp_general_consent",type:"checkbox",checked:a,onChange:e=>{const t=e.target.checked;r(t),t&&(i(!0),setTimeout(()=>{s(!1)},1e3))},className:"qlwapp__general-consent-checkbox",required:!0,"aria-required":"true"}),(0,e.createElement)("span",{className:"qlwapp__general-consent-text",dangerouslySetInnerHTML:{__html:u}}))):null},Z=(0,t.forwardRef)(({handleBoxClose:n},a)=>{const{contactId:o,setContactId:s}=f(),[c,l]=(0,t.useState)(""),i=null!==o;return(0,e.createElement)("div",{ref:a,className:r()("qlwapp__modal",i&&"qlwapp__modal--response",c)},(0,e.createElement)(x,{onClose:n,onPrevious:e=>{e.preventDefault(),l("qlwapp__modal--closing"),setTimeout(()=>{s(null),l("")},[300])}}),(0,e.createElement)("div",{className:"qlwapp__body"},(0,e.createElement)("div",{className:"qlwapp__carousel"},(0,e.createElement)("div",{className:"qlwapp__carousel-slide"},(0,e.createElement)(P,{onClick:l})),(0,e.createElement)("div",{className:"qlwapp__carousel-slide"},null!==o&&(0,e.createElement)(K,null)))),(0,e.createElement)(Y,null),(0,e.createElement)(k,null))}),X=(0,t.forwardRef)((t,n)=>(0,e.createElement)(Z,{...t,ref:n})),Q=t=>(e=>!(!e||"string"!=typeof e)&&(e.startsWith("http")||e.startsWith("https")||/\.(jpg|jpeg|png|gif|svg|webp)$/i.test(e)||e.includes(".")))(t)?(0,e.createElement)("img",{src:t,alt:"Custom Icon",className:"qlwapp__icon"}):(0,e.createElement)("i",{className:r()("qlwapp__icon",t)}),ee=function({onClick:t}){const{button:n,isModalOpen:a}=f(),{isAvailableNow:o,isInAvailableDay:s,isInAvailableHour:l,timefrom:i,timeto:p}=L(n);if(!o&&"hidden"===n.visibility)return;const u=M(n);return(0,e.createElement)("a",{className:r()("qlwapp__button",`qlwapp__button--${n.layout}`,!o&&"qlwapp__button--disabled"),role:"button",tabIndex:"0",onClick:e=>(e=>{e.preventDefault(),"yes"===n.box?t(e):(e=>{e.preventDefault(),A(n)})(e)})(e)},"image"===n.layout?Q(n.icon):(0,e.createElement)(e.Fragment,null,Q(n.icon),"bubble"===n.layout&&(0,e.createElement)("i",{className:"qlwapp__close"},"×"),n.text&&(0,e.createElement)("span",{className:"qlwapp__text"},n.text)),"bubble"===n.notification_bubble&&o&&!a&&(0,e.createElement)("span",{className:r()("qlwapp__notification-bubble",n.notification_bubble_animation&&`qlwapp__notification-bubble--${n.notification_bubble_animation}`),"aria-label":(0,c.__)("New message notification","wp-whatsapp-chat")},"1"),s?!l&&(0,e.createElement)("span",{className:"qlwapp__time"},(0,c.sprintf)((0,c._x)("Available from %1$s to %2$s","wp-whatsapp-chat"),i,p)):u&&(0,e.createElement)("span",{className:"qlwapp__time"},(0,c.sprintf)((0,c._x)("Available on %s","wp-whatsapp-chat"),u)))},te=()=>window.innerWidth<=430&&I(),ne=({children:n,containerRef:a,boxTransitionClass:o,isMobilePreview:s})=>{const[c,l]=(0,t.useState)(te()),{button:i}=f(),p="yes"===i.rounded;(0,t.useEffect)(()=>{const e=()=>{l(te())};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const u=c||s;return(0,e.createElement)("div",{ref:a,className:r()("qlwapp__container",`qlwapp__container--${i.position}`,p&&"qlwapp__container--rounded",u&&"qlwapp-is-mobile",o)},n)},ae=e=>!("hide"===e||"desktop"===e&&I()||"mobile"===e&&!I()),re=e=>e?(Array.isArray(e)||(e=Object.values(e)),e.filter(e=>{const t=ae(e?.display?.devices),n="hidden"===e?.visibility&&!L(e).isAvailableNow;return t&&!n}).sort((e,t)=>{const n=void 0!==e.order&&null!==e.order?e.order:Number.MAX_SAFE_INTEGER,a=void 0!==t.order&&null!==t.order?t.order:Number.MAX_SAFE_INTEGER;return n===a?0:n<a?-1:1})):[],oe=(0,t.memo)(n=>{const{box:a,button:r,contacts:o,isMobilePreview:s,previewContainerRef:c}=n,l=re(o),i=(0,t.useRef)(null),p=(0,t.useRef)(null),[u,d]=(0,t.useState)(!1),[m,_]=(0,t.useState)(""),w="qlwapp_box_closed",g="yes"===a.auto_open&&"yes"===r.box,h="true"===function(e){const t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null}(w),b=Number(a.auto_delay_open);(0,t.useEffect)(()=>{g&&!h&&setTimeout(()=>{d(!0)},b)},[]),(0,t.useEffect)(()=>{const e=a.allow_outside_close||"no",t=t=>{u&&"yes"===e&&p.current&&!p.current.contains(t.target)&&(c?.current?c.current.contains(t.target)&&f(t):f(t))};if(u&&"yes"===e)return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[u,a.allow_outside_close,c]);const f=e=>{e?.preventDefault(),_("qlwapp__container--closing"),function(e){let t="";{const e=new Date;e.setTime(e.getTime()+6048e5),t="; expires="+e.toUTCString()}document.cookie=e+"=true"+t+"; path=/"}(w),setTimeout(()=>{d(!1),_("")},300)};return(0,e.createElement)(y,{...n,contacts:l,isModalOpen:u},(0,e.createElement)(ne,{isMobilePreview:s,boxTransitionClass:m,containerRef:i},u&&(0,e.createElement)(X,{ref:p,handleBoxClose:f}),(0,e.createElement)(ee,{onClick:()=>{u?f():(d(!0),_("qlwapp__container--opening"),setTimeout(()=>{_("qlwapp__container--open")},300))}})))});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".qlwapp").forEach(n=>{var a,r,o,s;const c=null!==(a=JSON.parse(n.getAttribute("data-display")))&&void 0!==a?a:{};if(!ae(c?.devices))return;const l=null!==(r=JSON.parse(n.getAttribute("data-button")))&&void 0!==r?r:{},i=null!==(o=JSON.parse(n.getAttribute("data-box")))&&void 0!==o?o:{},p=re(null!==(s=JSON.parse(n.getAttribute("data-contacts")))&&void 0!==s?s:[]);void 0!==t.createRoot?(0,t.createRoot)(n).render((0,e.createElement)(oe,{display:c,button:l,box:i,contacts:p})):(0,t.render)((0,e.createElement)(oe,{display:c,button:l,box:i,contacts:p}),n)}),document.addEventListener("click",e=>{const t=e.target.closest('[data-action="open"]');if(!t)return;e.preventDefault();const n=t.dataset.phone,a=t.dataset.message,r=t.dataset.whatsappLinkType||"api";if(!n)return;const o=q({type:"phone",phone:n,message:a,whatsappLinkType:r}),s=new CustomEvent("qlwapp.click",{bubbles:!0,cancelable:!0});window.dispatchEvent(s),window.open(o,"_blank","noreferrer")})})})()})();